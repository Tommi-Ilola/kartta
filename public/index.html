<!DOCTYPE html>
<html lang="fi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ratakilometri kartta</title>
    <link rel="icon" href="Logo.png">
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="https://unpkg.com/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-contextmenu/dist/leaflet.contextmenu.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
          integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
          crossorigin=""/>
	<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css"/>
	<link rel="stylesheet" href="https://unpkg.com/@geoman-io/leaflet-geoman-free/dist/leaflet-geoman.css" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet.polylinemeasure/Leaflet.PolylineMeasure.css" />
	
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.7.5/proj4.js"></script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD6xHt1pJsao4zBQzlWrKtSctVYjRGVrYY" async defer></script>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet-src.js"
            integrity="sha512-I5Hd7FcJ9rZkH7uD01G3AjsuzFy3gqz7HIJvzFZGFt2mrCS4Piw9bYZvCgUE0aiJuiZFYIJIwpbNnDIM6ohTrg=="
            crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.gridlayer.googlemutant@latest/dist/Leaflet.GoogleMutant.js"></script>
	
	
	<script src="https://unpkg.com/leaflet.polylinemeasure/Leaflet.PolylineMeasure.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/leaflet-contextmenu/dist/leaflet.contextmenu.min.js"></script>

	<script src="https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/togeojson/3.0.0/togeojson.min.js"></script>
	<script src="https://unpkg.com/leaflet.locatecontrol/dist/L.Control.Locate.min.js"></script>
	<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
	<script src="https://unpkg.com/@geoman-io/leaflet-geoman-free/dist/leaflet-geoman.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
	
</head>

<body>
<!-- Salasanan syöttömodaali -->
<div id="passwordModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h1 style="font-family: calibri;">Anna salasana päästäksesi sivulle</h1>
		<input type="password" id="passwordInput">
        <button id="passwordButton" style="font-family: calibri;" onclick="verifyPassword()">Tarkista salasana</button>
    </div>
</div>

<div id="map"></div>
	
<div id="protected-content" style="display:none">
	<button id="removeMarkersButton" style="display:none">Tyhjennä kartta ja sulje haku</button>
	
	<div id="menuContainer">
		<button id="menuButton">
			<img src="layers.png" alt="Suodatin" style="width: 24px; height: 25px;">
			<span class="close-icon" style="display: none;">&#x2715;</span>
		</button>
		<div id="menuContent" style="display: none; font-family: calibri;">
			<label><input type="checkbox" id="tunnelitCheckbox"> Näytä tunnelit</label>
			<label><input type="checkbox" id="sillatCheckbox"> Näytä sillat</label>
			<label><input type="checkbox" id="tasoristeyksetCheckbox"> Näytä tasoristeykset</label>
			<label><input type="checkbox" id="tilirataosatCheckbox"> Näytä tilirataosat</label>
			<label><input type="checkbox" id="kilometrimerkitCheckbox" checked> Näytä kilometrimerkit</label>
			<label><input type="checkbox" id="kayttokeskusalueetCheckbox"> Näytä käyttökeskusalueet</label>
			<label><input type="checkbox" id="RadatCheckbox"> Näytä radat</label>
			<label><input type="checkbox" id="ToimialueetCheckbox"> Näytä toimialueet</label>
			<label><input type="checkbox" id="SyottoAsematCheckbox"> Näytä syöttöasemat</label>
			<label><input type="checkbox" id="VKCheckbox"> Näytä välikytkiasemat</label>
			<label><input type="checkbox" id="LaCheckbox"> Näytä vaununlämmitysasemat</label>
			<label><input type="checkbox" id="JunatCheckbox"> Näytä junat kartalla</label>
			
			<span id="fileContent" style="display: flex; flex-direction: column;">
				<div id="files"></div>
				<label for="file-input" class="custom-file-upload">
					Lisää tiedosto
				</label>
				<input type="file" id="file-input" accept=".gpx, .geojson, .kml, .csv" />
			</span>
		</div>
	</div>

	<span>
	<button id="toggleView">
	<img src="maa.png" alt="Maapallo" style="
		width: auto;
		height: -webkit-fill-available;
	">
	</button>
	</span>
		
<div class="searchContainer">
	<div id="loadData" style="position: absolute; background-color: white; font-family: calibri; height: -webkit-fill-available;width: -webkit-fill-available; text-align: center;padding: 10px;color: #ccc;">Ladataan dataa</div>
		<div class="searchBox">
			<input type="text" id="searchInput" placeholder="Syötä hakuehto...">
			<button id="searchButton" type="button">
				<span class="magnifier"><img src="magnifier.svg" style="width: 20px;height: 20px;"></span>
				<span class="close-icon" style="display: none;">&#x2715;</span>
			</button>
		</div>
	<div id="loading" style="display: none; background-color: white; padding: 0px 0px 5px 15px; font-family: calibri; font-weight: bold;">Ladataan...</div>
	<div id="virhe" style="display: none; color: red; background-color: white; padding: 0px 0px 5px 15px; font-family: calibri; font-weight: bold;"></div>
		<div class="resultbox">
			<button type="button" class="collapsible"></button>
			<div class="content">
				<div class="results" id="results"></div>
			</div>
		</div>
		
	</div>
</div>
	
<script>
document.addEventListener("DOMContentLoaded", function() {
    var coll = document.getElementsByClassName("collapsible");
    var resultsDiv = document.getElementById("results");
	resultsDiv.style.display = "none";

    function toggleCollapsibleVisibility() {
        // Tarkistetaan, onko results-div näkyvissä
        var isResultsVisible = resultsDiv.style.display !== "none";

        // Asetetaan collapsible-elementtien näkyvyys results-divin näkyvyyden mukaan
        for (var i = 0; i < coll.length; i++) {
            coll[i].style.display = isResultsVisible ? "block" : "none";
        }
    }

    for (var i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "none") {
                content.style.display = "block";
            } else {
                content.style.display = "none";
            }
        });
    }

    // Asetetaan alustava näkyvyys
    toggleCollapsibleVisibility();

    // Tarkistetaan ja asetetaan näkyvyys aina kun results-divin tila muuttuu
    var observer = new MutationObserver(toggleCollapsibleVisibility);
    observer.observe(resultsDiv, { attributes: true, childList: true, subtree: true });
});
</script>

<script src="script.js"></script>
<script src="mapsetup.js"></script>
<script src="layers.js"></script>
<script src="Geolocate.js"></script>
<script src="karttahaku.js"></script>
<script src="haku.js"></script>
<script src="uploadfile.js"></script>
	
</body>

</html>




